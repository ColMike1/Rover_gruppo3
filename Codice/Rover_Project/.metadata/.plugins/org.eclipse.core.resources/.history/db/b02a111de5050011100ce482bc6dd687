/*
 * board_health_snapshot.h
 *
 *  Created on: Jan 8, 2026
 *      Author: Sterm
 */

#ifndef INC_SNAPSHOT_BOARD_HEALTH_SNAPSHOT_H_
#define INC_SNAPSHOT_BOARD_HEALTH_SNAPSHOT_H_

#include <stdint.h>
#ifdef MATLAB_MEX_FILE
  #include "cmsis_os.h"
#endif


typedef struct
{
  float temperature_degC;		/* ultima lettura valida della temperatura */
  float battery_pct;			/* ultima lettura valida della batteria */

  uint32_t task_last_run_ms;     /* ultima esecuzione del task */

  uint32_t temp_last_valid_ms;	/* ultima rilevazione valida della temperatura */
  uint32_t batt_last_valid_ms;	/* ultima rilevazione valida della batteria */
} BoardHealthSnapshot_t;


#ifdef MATLAB_MEX_FILE
/* Inizializzazione del mutex relativo allo snapshot Board Health */
void BoardHealthSnapshot_MutexInit(osMutexId_t mutex_handle);
#endif

/* Writer API (chiamata esclusivamente dal task Board Health) */
void BoardHealthSnapshot_Write(const BoardHealthSnapshot_t *src);

/* Reader API (chiamata dai task interessati a leggere i dati prodotti) */
void BoardHealthSnapshot_Read(BoardHealthSnapshot_t *dst);


#endif /* INC_SNAPSHOT_BOARD_HEALTH_SNAPSHOT_H_ */
